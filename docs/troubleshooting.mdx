---
title: "Troubleshooting & Diagnostics"
description: "Common issues and solutions for troubleshooting dstack deployments"
---

## Common Issues & Solutions

---

### 1. Services Fail to Start

**Problem:**  
Services (`dstack-vmm`, `dstack-gateway`, or `dstack-kms`) fail to initialize or immediately crash.

**Solution:**  
Check logs and system status:
```bash
journalctl -u dstack-vmm -n 50
journalctl -u dstack-gateway -n 50
journalctl -u dstack-kms -n 50
````

Ensure required ports (`8000`, `9080`, `443`) are free:

```bash
sudo netstat -tlnp | grep -E '8000|9080|443'
```

Verify hardware support (TDX enabled):

```bash
dmesg | grep -i "tdx.*error"
```

Correct configuration errors in `vmm.toml`, `gateway.toml`, or `kms.toml`.

> **Developer Suggestion:**  
> ensure proper hardware setup and validate configurations before restarting services.

---

### 2. Confidential VM (CVM) Deployment Issues

**Problem:**
CVMs fail to deploy or crash immediately after launch.

**Solution:**
Check CID allocation and resource availability:

```bash
grep "CID.*exhausted" /var/log/dstack/vmm.log
df -h /var/lib/dstack
free -h
```

Verify guest image integrity:

```bash
sha256sum /var/lib/dstack/images/dstack-guest-*.img
```

Re-download corrupted images:

```bash
./build.sh dl 0.5.1 --verify --force
```

> **Developer Suggestion:**  
> regularly check CID usage and available storage to prevent resource exhaustion, and periodically verify the integrity of your guest images to avoid deployment failures.

---

### 3. Attestation Verification Failures

**Problem:**
Remote attestation consistently fails.

**Solution:**
Verify hardware and TDX support:

```bash
cat /sys/firmware/tdx/tdx_module/status
```

Check for measurement mismatches:

```bash
dstack-attest compare --baseline baseline.json --current current.json
```

Update TCB and microcode:

```bash
sudo apt update && sudo apt upgrade intel-sgx tdx-module
```

> **Developer Suggestion:**  
>  
> **keep your TCB and Intel microcode up-to-date** to ensure your platform passes attestation checks and remains protected against known vulnerabilities.  
>  
> **always use consistent, reproducible image builds**—even small differences in build environments or dependencies can cause measurement mismatches and attestation failures.

---

### 4. Network Connectivity Issues

**Problem:**
CVMs cannot communicate externally or internally.

**Solution:**
Verify WireGuard configuration:

```bash
sudo wg show
```

Inspect routing tables and firewall rules:

```bash
ip route show table all | grep wg0
sudo iptables -L -n -v | grep dstack
```

Test connectivity via vsock:

```bash
vsock-ping --cid <CVM_CID> --port 8080
```

> **Developer Suggestion:**  
>  
> **regularly review and test your network configurations** to ensure CVMs can communicate as intended.  
>  
> **keep firewall and routing rules clean and up-to-date**—misconfigured or outdated rules are a common cause of connectivity issues and can introduce security risks.

---

### 5. Performance Degradation

**Problem:**
Significant performance degradation in CVMs.

**Solution:**
Monitor resources:

```bash
iostat -x 1 5
free -h
```

Benchmark TEE workloads:

```bash
dstack-vmm benchmark --workload crypto --iterations 500
```

Adjust resources or tune configurations as required.

> **Developer Suggestion:**  
>  
> **regularly benchmark and document your system's baseline performance**—this helps you quickly identify when and where degradation occurs. If you notice a drop in performance, review your resource allocation (CPU, memory, storage) and adjust configurations as needed to restore optimal operation. Consistent monitoring and tuning are key to maintaining healthy CVMs.

---

### 6. Security Incident Response

**Problem:**
Suspected or confirmed security breach.

**Solution:**
Isolate CVMs immediately:

```bash
dstack-cli isolate --cvm-id <id> --reason "security incident"
```

Collect evidence securely:

```bash
dstack-attest snapshot --all --output incident.tar.gz
```

Enable verbose logging:

```bash
dstack-vmm loglevel --set trace
```

> **Developer Suggestion:**  
>  
> **always maintain a clearly documented incident response plan**—this ensures your team can act quickly and effectively in the event of a security breach.  
>  
> **proactively and regularly review all relevant logs for suspicious activity** to detect incidents early and minimize potential impact.

---

## Best Practices for Issue Reporting and Resolution

- clearly document issue symptoms and steps to reproduce  
- label GitHub issues correctly (`bug`, `enhancement`, or `documentation`)  
- attach logs, screenshots, or diagnostic outputs for quicker resolution  
- allow 1-3 days for responses from core contributors  

---

**Remember:**
Efficient troubleshooting strengthens the dstack platform—your detailed reports and solutions significantly contribute to our community's success.


