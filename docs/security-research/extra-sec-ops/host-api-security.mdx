---
title: "Host API Security"
description: "Secure host management and orchestration API for dstack TEE infrastructure"
---


# Host API Security Architecture

The Host API implements a **three-endpoint secure interface** for TEE host management, providing critical security services including host information retrieval, event notification handling, and sealing key provisioning [1](#0-0) . The API server is implemented as part of the VMM component using the RA-RPC framework for secure remote procedure calls [2](#0-1) .

## Cryptographic Security Implementation

### Core Cryptographic Primitives

The system employs **military-grade cryptographic algorithms** including:

- **HKDF-SHA256** for secure key derivation using a "RATLS" salt [3](#0-2) 
- **ECDSA P-256** for digital signatures with PKCS#8 encoding [4](#0-3) 
- **X25519** for Diffie-Hellman key exchange derived from ECDSA keys [5](#0-4) 
- **Multi-algorithm hash support** including SHA-256/384/512, SHA-3, and Keccak variants [6](#0-5) 

### Key Derivation Security

The key derivation function implements **cryptographically secure context-based derivation** where derived keys are generated using HKDF with configurable context data and output sizes up to 256 bytes [7](#0-6) . The system ensures **forward secrecy** through proper key rotation and derivation chains.

## Authentication & Authorization Framework

### Mutual TLS Authentication

The Host API enforces **strict mutual TLS authentication** with client certificate verification and attestation validation [8](#0-7) . The authentication system extracts and validates **app-specific identifiers** from client certificates using custom OID extensions [9](#0-8) .

### Certificate-Based Security

The system uses **custom X.509 certificate extensions** with enterprise OIDs for embedding attestation data:
- **Quote Extension** (OID: 1.3.6.1.4.1.62397.1.1) for SGX/TDX quotes
- **Event Log Extension** (OID: 1.3.6.1.4.1.62397.1.2) for TDX event logs  
- **App ID Extension** (OID: 1.3.6.1.4.1.62397.1.3) for application identification
- **Certificate Usage Extension** (OID: 1.3.6.1.4.1.62397.1.4) for special certificate purposes [10](#0-9) 

## Intel TDX Attestation & Verification

### Hardware-Backed Security

The attestation system implements **comprehensive TDX quote verification** using Intel's DCAP QVL library for collateral retrieval and verification [11](#0-10) . The system performs **strict TCB validation** including debug mode prevention and signer verification [12](#0-11) .

### Runtime Measurement Validation

The system implements **cryptographic event log replay** using SHA-384 hashing to validate Runtime Measurement Registers (RTMRs) ensuring boot-time and runtime integrity [13](#0-12) . Event logs are validated against computed measurements with **strict matching requirements** [14](#0-13) .

### Quote Content Validation

The attestation framework supports **multiple content types** for quote data validation including KMS root CA, RA-TLS certificates, and application-specific data with configurable hash algorithms [15](#0-14) .

## Secure Key Management System

### Sealing Key Provisioning

The Host API provides **hardware-backed sealing key provisioning** through integration with dedicated key provider services [16](#0-15) . The system uses **NaCl sealed boxes** for secure key transport with public key cryptography [17](#0-16) .

### Key Provider Security

The key provider communication implements **secure TCP-based protocols** with length-prefixed JSON messaging and **1MB payload limits** for quote transmission [18](#0-17) . All key operations require **valid TDX quotes** and **SGX enclave verification** before key release.

### Cryptographic Key Hierarchy

The KMS system manages **multiple key types** including:
- **TLS CA certificates** for trust anchor establishment
- **Disk encryption keys** for full disk encryption
- **Environment variable encryption keys** (X25519)
- **ECDSA keys** for Ethereum-compatible signing operations
- **K256 signatures** with root key validation [19](#0-18) 

## Communication Security Architecture

### VSOCK-Based Isolation

The Host API uses **VSOCK communication channels** for secure host-guest isolation with dedicated CID and port assignments [20](#0-19) . This provides **hardware-enforced isolation** between the host and guest environments.

### Request Processing Security

The system implements **comprehensive request validation** with configurable size limits, content-type verification, and **method-specific payload restrictions** [21](#0-20) . All requests undergo **multi-layer security processing** including attestation verification and certificate validation.

## Advanced Security Controls

### VM Lifecycle Security

The VMM provides **secure VM lifecycle management** with hardware isolation controls including:
- **NUMA node pinning** for hardware isolation
- **Hugepage allocation** for performance and security
- **GPU attachment security** with PCI device validation
- **Resource quota enforcement** per tenant [22](#0-21) 

### Multi-Tenant Isolation

The system enforces **strict tenant isolation** through:
- **Hardware resource partitioning** via NUMA nodes
- **Memory and CPU quota limits** with configurable maximums
- **Network isolation** with dedicated address spaces
- **Encrypted environment variables** per application [23](#0-22) 

## Certificate Authority Security

### RA-TLS Certificate Generation

The system implements **secure RA-TLS certificate generation** with embedded attestation data and configurable validity periods up to 10 years [24](#0-23) . Certificates include **digitally signed attestation quotes** and **event logs** for complete verification.

### Certificate Signing Security

The certificate signing process implements **strict validation requirements** including:
- **Confirmation word verification** ("please sign cert:")
- **ECDSA signature validation** using P-256 curves
- **Public key format verification** with DER encoding
- **Algorithm compatibility checks** [25](#0-24) 

## Production Security Configuration

### TLS Configuration Security

The KMS implements **enterprise-grade TLS configuration** with:
- **Mutual TLS enforcement** with CA certificate validation
- **Configurable client certificate requirements**
- **Dedicated certificate directories** for secure storage
- **Subject name validation** with domain verification [26](#0-25) 

### Authentication API Integration

The system supports **multiple authentication backends** including webhook-based authentication and development mode overrides with configurable gateway app ID validation [27](#0-26) .

## Security Audit & Monitoring

### Comprehensive Event Logging

The Host API implements **detailed security event logging** with request tracing, method identification, and **unique request ID assignment** for audit trail maintenance [28](#0-27) .

### Error Handling Security

The system implements **secure error handling** with sanitized error messages and **structured error encoding** that prevents information disclosure while maintaining debugging capability [29](#0-28) .

## Threat Mitigation Analysis

### Hardware-Based Security

The Host API leverages **Intel TDX hardware security features** including:
- **Measured boot processes** with RTMR validation
- **Debug mode prevention** in production environments  
- **Signer verification** for trusted execution environments
- **Hardware-backed attestation** with DCAP integration

### Network Security

The system implements **defense-in-depth network security** including:
- **Rate limiting** with configurable request limits
- **Payload size restrictions** to prevent DoS attacks
- **Content-type validation** for request integrity
- **Endpoint isolation** through VSOCK channels

## Security Compliance & Standards

The Host API security implementation aligns with **enterprise security standards** including:
- **NIST guidelines** for cryptographic implementations
- **Intel TDX specifications** for attestation protocols
- **Zero-trust architecture** principles with continuous verification
- **Defense-in-depth** security strategies with multiple validation layers

## Notes

The dstack Host API implements a **comprehensive security architecture** with hardware-backed attestation, cryptographically sound key management, and defense-in-depth protections. The system leverages Intel TDX technology for hardware-based security guarantees while implementing enterprise-grade authentication, authorization, and communication security. All cryptographic implementations use industry-standard algorithms with proper key derivation and validation procedures. The multi-layered security approach ensures protection against various threat vectors while maintaining high performance and scalability for confidential computing workloads.
